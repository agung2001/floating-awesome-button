var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(e,t,a){if(a||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))};window.FAB_METABOX_LOCATION=__assign(__assign({},window.FAB_METABOX_LOCATION),{defaultOptions:__assign(__assign({},window.FAB_METABOX_LOCATION.defaultOptions),{select2:{placeholder:"--choose--"},type:[],post_types:[]}),init:function(){jQuery("#post").on("submit",function(){var e=window.FAB_METABOX_LOCATION.check_invalid_rules();if(1==jQuery("#fab-location-rules .fab-location-rule-item").length&&e){var t=jQuery("#fab-location-rules .fab-location-rule-item").last();return jQuery('.select2[name="fab_location_type[]',t).val(""),jQuery('.select2[name="fab_location_type[]',t).trigger("change"),jQuery('.select2[name="fab_location_operator[]',t).val(""),jQuery('.select2[name="fab_location_operator[]',t).trigger("change"),jQuery('.select2[name="fab_location_value[]',t).val(""),jQuery('.select2[name="fab_location_value[]',t).trigger("change"),jQuery('.select2[name="fab_location_logic[]',t).val(""),jQuery('.select2[name="fab_location_logic[]',t).trigger("change"),!0}return e&&jQuery.dialog({icon:"fas fa-times",closeIcon:!0,animation:"scale",columnClass:"j-small",title:"Error",content:"Please check input, there are invalid location rules!"}),!e})},init_type_options:function(){var e=window.FAB_METABOX_LOCATION.post_types;e=(e=Object.keys(e).sort().map(function(t,a){return{id:t,text:e[t].label}})).filter(function(e,t){return!window.FAB_METABOX_LOCATION.excludes_post_types.includes(e.id)});var t=window.FAB_METABOX_LOCATION.post_taxonomies;t=Object.keys(t).sort().map(function(e,a){return{id:e,text:t[e].labels.name}}),window.FAB_METABOX_LOCATION.defaultOptions.post_types=e,window.FAB_METABOX_LOCATION.defaultOptions.type=__spreadArray(__spreadArray([],window.FAB_METABOX_LOCATION.defaultOptions.type,!0),[{text:"Post",children:__spreadArray([{id:"post_type",text:"Post Type"}],e.map(function(e,t){var a=e.text.substr(e.text.length-1);return a="s"===a?e.text.substring(0,e.text.length-1):e.text,{id:"single_".concat(e.id),text:"Single ".concat(a)}}),!0)},{text:"Taxonomy",children:__spreadArray([],t.map(function(e,t){return{id:"taxonomy_".concat(e.id),text:"".concat(e.text," (").concat(e.id,")")}}),!0)},{text:"User",children:[{id:"user_session",text:"Session"},{id:"user_role",text:"Role"}]}],!1)},check_invalid_rules:function(){var e=!1;return jQuery("#fab-location-rules .fab-location-rule-item").each(function(){return jQuery('.select2[name="fab_location_type[]',this).val()&&jQuery('.select2[name="fab_location_operator[]',this).val()&&jQuery('.select2[name="fab_location_value[]',this).val()&&jQuery('.select2[name="fab_location_logic[]',this).val()?void 0:(e=!0,!1)}),e},reloadSelect2:function(e,t){t.selectedValue||(t.selectedValue=e.val()),e.data("select2")&&(e.select2("destroy"),e.html("")),e.select2(t),e.val(t.selectedValue),e.trigger("change")},getComparatorOption:function(e,t){return void 0!==e&&e&&("post_type"===e?t.data=window.FAB_METABOX_LOCATION.defaultOptions.post_types:e.includes("taxonomy_")?t.ajax=window.FAB_METABOX_LOCATION.getComparatorOptionTaxonomyTermAjax(e):"user_session"===e?t.data=[{id:"user_session_logged_in",text:"Logged In"}]:"user_role"===e?t.data=window.FAB_METABOX_LOCATION.defaultOptions.user.roles:e.includes("single_")&&(t.ajax=window.FAB_METABOX_LOCATION.getComparatorOptionSingleAjax(e))),t},getComparatorOptionSingleAjax:function(e){return{delay:500,dataType:"json",url:function(t){e=e.replace("single_","");var a=window.FAB_METABOX_LOCATION.post_types[e].rest_base;return a=a||e,a+=window.FAB_PLUGIN.isNumeric(t.term)?"/".concat(t.term):"","".concat(window.FAB_METABOX_LOCATION.rest_url,"wp/v2/").concat(a)},data:function(e){var t={_fields:"id,title"};return window.FAB_PLUGIN.isNumeric(e.term)||(t=__assign(__assign({},t),{filter:{post_status:"publish,private"},page:e.page||1,search:e.term,orderby:"title",order:"asc"})),window.FAB_METABOX_LOCATION.ajax_params=t,t},processResults:function(e){var t={more:!1};return window.FAB_METABOX_LOCATION.ajax_params.page<this._request.getResponseHeader("X-WP-TotalPages")&&(t.more=!0),Array.isArray(e)||(e=[e]),{results:e=e.map(function(e,t){return{id:e.id,text:e.title.rendered.replace(/[^\w\s]/gi,"")}}),pagination:t}}}},getComparatorOptionTaxonomyTermAjax:function(e){return{delay:500,dataType:"json",url:function(t){e=e.replace("taxonomy_","");var a=window.FAB_METABOX_LOCATION.post_taxonomies[e].rest_base;return a=a||e,a+=window.FAB_PLUGIN.isNumeric(t.term)?"/".concat(t.term):"","".concat(window.FAB_METABOX_LOCATION.rest_url,"wp/v2/").concat(a)},data:function(e){var t={};return window.FAB_PLUGIN.isNumeric(e.term)||(t={page:e.page||1,per_page:10,search:e.term}),window.FAB_METABOX_LOCATION.ajax_params=t,t},processResults:function(e){var t={more:!1};return window.FAB_METABOX_LOCATION.ajax_params.page<this._request.getResponseHeader("X-WP-TotalPages")&&(t.more=!0),{results:e=e.map(function(e,t){return{id:e.id,text:e.name.replace(/[^\w\s]/gi,"")}}),pagination:t}}}}});