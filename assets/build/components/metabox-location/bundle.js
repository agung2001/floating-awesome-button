var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function l(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function i(e){e.parentNode.removeChild(e)}function s(e){return document.createElement(e)}function u(e){return document.createTextNode(e)}function d(){return u(" ")}function f(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function p(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}let m;function _(e){m=e}function h(){if(!m)throw new Error("Function called outside component initialization");return m}function g(){const e=h();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const l=function(e,t,n=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(e,n,!1,t),o}(t,n);o.slice().forEach((t=>{t.call(e,l)}))}}}const $=[],w=[],y=[],b=[],O=Promise.resolve();let v=!1;function A(e){y.push(e)}const T=new Set;let x=0;function B(){const e=m;do{for(;x<$.length;){const e=$[x];x++,_(e),E(e.$$)}for(_(null),$.length=0,x=0;w.length;)w.pop()();for(let e=0;e<y.length;e+=1){const t=y[e];T.has(t)||(T.add(t),t())}y.length=0}while($.length);for(;b.length;)b.pop()();v=!1,T.clear(),_(e)}function E(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(A)}}const M=new Set;let L;function k(e,t){e&&e.i&&(M.delete(e),e.i(t))}function C(e,t,n,o){if(e&&e.o){if(M.has(e))return;M.add(e),L.c.push((()=>{M.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}function I(e,t){C(e,1,1,(()=>{t.delete(e.key)}))}function N(e,n,r,a){const{fragment:c,on_mount:i,on_destroy:s,after_update:u}=e.$$;c&&c.m(n,r),a||A((()=>{const n=i.map(t).filter(l);s?s.push(...n):o(n),e.$$.on_mount=[]})),u.forEach(A)}function F(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function X(e,t){-1===e.$$.dirty[0]&&($.push(e),v||(v=!0,O.then(B)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function j(t,l,r,a,c,s,u,d=[-1]){const f=m;_(t);const p=t.$$={fragment:null,ctx:null,props:s,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(f?f.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:l.target||f.$$.root};u&&u(p.root);let h=!1;if(p.ctx=r?r(t,l.props||{},((e,n,...o)=>{const l=o.length?o[0]:n;return p.ctx&&c(p.ctx[e],p.ctx[e]=l)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](l),h&&X(t,e)),n})):[],p.update(),h=!0,o(p.before_update),p.fragment=!!a&&a(p.ctx),l.target){if(l.hydrate){const e=function(e){return Array.from(e.childNodes)}(l.target);p.fragment&&p.fragment.l(e),e.forEach(i)}else p.fragment&&p.fragment.c();l.intro&&k(t.$$.fragment),N(t,l.target,l.anchor,l.customElement),B()}_(f)}class S{$destroy(){F(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function H(t){let n,l,r,u,m,_,h,g,$,w,y,b,O,v,A,T,x,B;return{c(){n=s("div"),l=s("div"),l.innerHTML='<div class="inline-block py-2.5 mx-auto px-5 bg-white text-gray-500 border border-text-gray-300 rounded-md cursor-grab"><em class="fas fa-bars"></em></div>',r=d(),u=s("div"),u.innerHTML='<select name="fab_location_type[]" class="select2"></select>',m=d(),_=s("div"),_.innerHTML='<select name="fab_location_operator[]" class="select2"></select>',h=d(),g=s("div"),g.innerHTML='<select name="fab_location_value[]" class="w-full select2"></select>',$=d(),w=s("div"),w.innerHTML='<select name="fab_location_logic[]" class="w-full select2"></select>',y=d(),b=s("div"),O=s("button"),O.innerHTML='<em class="fas fa-minus"></em>',v=d(),A=s("button"),A.innerHTML='<em class="fas fa-plus"></em>',p(l,"class","w-14"),p(u,"class","w-2/12"),p(_,"class","w-2/12"),p(g,"class","w-4/12"),p(w,"class","w-1/12"),p(O,"type","button"),p(O,"class","remove-rule-item py-2.5 mx-auto px-5 bg-danger-600 text-white rounded-md cursor-pointer hover:shadow-md"),p(A,"type","button"),p(A,"class","add-rule-item py-2.5 mx-auto px-5 bg-primary-600 text-white rounded-md cursor-pointer hover:shadow-md"),p(b,"class","w-1/12"),p(n,"id",T="fab-location-rule-"+t[0].id),p(n,"class","fab-location-rule-item flex my-2 gap-2")},m(e,o){c(e,n,o),a(n,l),a(n,r),a(n,u),a(n,m),a(n,_),a(n,h),a(n,g),a(n,$),a(n,w),a(n,y),a(n,b),a(b,O),a(b,v),a(b,A),x||(B=[f(O,"click",t[2]),f(A,"click",t[3])],x=!0)},p(e,[t]){1&t&&T!==(T="fab-location-rule-"+e[0].id)&&p(n,"id",T)},i:e,o:e,d(e){e&&i(n),x=!1,o(B)}}}function Q(e,t,n){let{rule:o={}}=t,l=g();function r(){n(0,o.type=jQuery(this).val(),o),n(0,o.value=null,o),a(o)}const a=e=>{let t=jQuery(`#fab-location-rule-${e.id}`),n={placeholder:window.FAB_METABOX_LOCATION.defaultOptions.select2.placeholder},o=jQuery('.select2[name="fab_location_value[]',t);n=window.FAB_METABOX_LOCATION.getComparatorOption(e.type,n),void 0===n.data&&e.value&&e.value.ID?(n.data=[{id:e.value.ID,text:e.value.post_title}],n.selectedValue=e.value.ID):void 0===n.data&&e.value&&e.value.term_id?(n.data=[{id:e.value.term_id,text:e.value.name}],n.selectedValue=e.value.term_id):n.selectedValue=e.value,window.FAB_METABOX_LOCATION.reloadSelect2(o,n)};var c;c=async()=>{let e,t,n=jQuery(`#fab-location-rule-${o.id}`),l={placeholder:window.FAB_METABOX_LOCATION.defaultOptions.select2.placeholder};e=jQuery('.select2[name="fab_location_type[]"]',n),t={...l,data:window.FAB_METABOX_LOCATION.defaultOptions.type},o.type&&(t.selectedValue=o.type),window.FAB_METABOX_LOCATION.reloadSelect2(e,t),e.on("change",r),e.on("select2:select",r),e=jQuery('.select2[name="fab_location_operator[]"]',n),t={...l,data:window.FAB_METABOX_LOCATION.defaultOptions.operator},t.selectedValue=o.operator,window.FAB_METABOX_LOCATION.reloadSelect2(e,t),e=jQuery('.select2[name="fab_location_logic[]',n),t={...l,data:window.FAB_METABOX_LOCATION.defaultOptions.logic},t.selectedValue=o.logic,window.FAB_METABOX_LOCATION.reloadSelect2(e,t),a(o)},h().$$.on_mount.push(c);return e.$$set=e=>{"rule"in e&&n(0,o=e.rule)},[o,l,()=>{l("remove_rule_item",o.id)},()=>{l("add_rule_item")}]}class V extends S{constructor(e){super(),j(this,e,Q,H,r,{rule:0})}}function D(e,t,n){const o=e.slice();return o[3]=t[n],o}function q(e,t){let n,o,l;return o=new V({props:{rule:t[3]}}),o.$on("add_rule_item",t[1]),o.$on("remove_rule_item",t[2]),{key:e,first:null,c(){var e;n=u(""),(e=o.$$.fragment)&&e.c(),this.first=n},m(e,t){c(e,n,t),N(o,e,t),l=!0},p(e,n){t=e;const l={};1&n&&(l.rule=t[3]),o.$set(l)},i(e){l||(k(o.$$.fragment,e),l=!0)},o(e){C(o.$$.fragment,e),l=!1},d(e){e&&i(n),F(o,e)}}}function z(e){let t,n,l=[],r=new Map,a=e[0];const u=e=>e[3].id;for(let t=0;t<a.length;t+=1){let n=D(e,a,t),o=u(n);r.set(o,l[t]=q(o,n))}return{c(){t=s("div");for(let e=0;e<l.length;e+=1)l[e].c();p(t,"id","fab-location-rules")},m(e,o){c(e,t,o);for(let e=0;e<l.length;e+=1)l[e].m(t,null);n=!0},p(e,[n]){7&n&&(a=e[0],L={r:0,c:[],p:L},l=function(e,t,n,o,l,r,a,c,i,s,u,d){let f=e.length,p=r.length,m=f;const _={};for(;m--;)_[e[m].key]=m;const h=[],g=new Map,$=new Map;for(m=p;m--;){const e=d(l,r,m),c=n(e);let i=a.get(c);i?o&&i.p(e,t):(i=s(c,e),i.c()),g.set(c,h[m]=i),c in _&&$.set(c,Math.abs(m-_[c]))}const w=new Set,y=new Set;function b(e){k(e,1),e.m(c,u),a.set(e.key,e),u=e.first,p--}for(;f&&p;){const t=h[p-1],n=e[f-1],o=t.key,l=n.key;t===n?(u=t.first,f--,p--):g.has(l)?!a.has(o)||w.has(o)?b(t):y.has(l)?f--:$.get(o)>$.get(l)?(y.add(o),b(t)):(w.add(l),f--):(i(n,a),f--)}for(;f--;){const t=e[f];g.has(t.key)||i(t,a)}for(;p;)b(h[p-1]);return h}(l,n,u,1,e,a,r,t,I,q,null,D),L.r||o(L.c),L=L.p)},i(e){if(!n){for(let e=0;e<a.length;e+=1)k(l[e]);n=!0}},o(e){for(let e=0;e<l.length;e+=1)C(l[e]);n=!1},d(e){e&&i(t);for(let e=0;e<l.length;e+=1)l[e].d()}}}function P(e,t,n){window.FAB_METABOX_LOCATION.init_type_options();let o=0,l=[],r={id:o,type:null,operator:null,logic:null,value:null};window.FAB_METABOX_LOCATION.data.locations.length?(l=window.FAB_METABOX_LOCATION.data.locations,l=l.map((e=>({...e,id:o++})))):(l=[r],o++);return[l,()=>{n(0,l=[...l,{...r,id:o++}])},e=>{let t=e.detail;l.length>1?n(0,l=l.filter((e=>e.id!==t))):(n(0,l=[r]),o++)},r]}return app=new class extends S{constructor(e){super(),j(this,e,P,z,r,{})}}({target:document.querySelector("#fab-metabox-locations")})}();
